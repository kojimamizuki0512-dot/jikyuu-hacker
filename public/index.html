<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>時給ハッカー | コックピット（スモーク）</title>
    <style>
      /* ---- Design Tokens (Light Theme) ----
         Base:  #E9ECEF  （面積 61.8% 想定）
         Ink:   #343A40
         Accent:#FEC107  （面積 38.2% 想定）
      --------------------------------------*/
      :root{
        --base:#E9ECEF;      /* 背景ベース */
        --ink:#343A40;       /* 主要文字/枠 */
        --muted:#6C757D;     /* 補助文字 */
        --panel:#FFFFFF;     /* カード面 */
        --accent:#FEC107;    /* 行動色（CTA） */
        --accent-ink:#1F1F1F;/* アクセント上の文字 */
        --radius:14px;
        --shadow:0 8px 24px rgba(0,0,0,.10);
      }
      html,body{height:100%}
      body{
        margin:0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
        color:var(--ink);
        /* 黄金比分割の背景。61.8%までベース、以降にアクセントのごく薄いベール */
        background:
          linear-gradient(135deg,
            var(--base) 0,
            var(--base) 61.8%,
            rgba(254,193,7,0.12) 61.8%,
            rgba(254,193,7,0.12) 100%);
        display:grid; place-items:center;
      }
      .card{
        width:min(960px, 92vw);
        background:var(--panel);
        border:1px solid rgba(52,58,64,.10);
        border-radius:var(--radius);
        box-shadow:var(--shadow);
        padding:28px;
      }
      .row{display:flex; gap:16px; align-items:center; flex-wrap:wrap}
      .grow{flex:1}
      h1{margin:0 0 4px 0; font-size:22px; letter-spacing:.2px}
      .muted{color:var(--muted); font-size:13px}

      button{
        appearance:none; border:none; border-radius:12px; padding:12px 16px;
        font-weight:700; cursor:pointer; transition:.2s transform ease, .2s background;
        background:var(--accent); color:var(--accent-ink);
        box-shadow:0 2px 0 rgba(0,0,0,.08) inset;
      }
      button:hover{ filter:brightness(.95) }
      button.ghost{
        background:transparent; color:var(--ink);
        border:1px solid rgba(52,58,64,.25)
      }

      .grid{display:grid; grid-template-columns:repeat(3, 1fr); gap:12px; margin-top:16px}
      .stat{
        background:linear-gradient(180deg, #FFFFFF, #F8F9FA);
        border:1px solid rgba(52,58,64,.15);
        border-radius:12px; padding:14px
      }
      .stat .label{color:var(--muted); font-size:12px}
      .stat .val{font-size:20px; font-weight:800; margin-top:6px}

      .map{
        height:260px; border-radius:12px; margin-top:16px;
        background:
          linear-gradient(0deg, rgba(52,58,64,.06), rgba(52,58,64,.03)),
          repeating-linear-gradient(0deg, rgba(52,58,64,.10) 0 1px, transparent 1px 40px),
          repeating-linear-gradient(90deg, rgba(52,58,64,.10) 0 1px, transparent 1px 40px);
        display:grid; place-items:center; color:var(--muted);
      }
      .footer{margin-top:18px; color:var(--muted); font-size:12px; text-align:center}
      .rowbtn{display:flex; gap:10px; margin-top:14px; flex-wrap:wrap}
      .tag{
        background:rgba(254,193,7,.14); color:#8A6A00;
        border:1px solid rgba(254,193,7,.55);
        padding:6px 10px; border-radius:999px; font-size:12px
      }
      a{color:#8A6A00; text-decoration:none}
      a:hover{text-decoration:underline}
      .hidden{display:none}
    </style>
  </head>
  <body>
    <div class="card">
      <div class="row">
        <div class="grow">
          <h1>時給ハッカー — コックピット（スモーク）</h1>
          <div class="muted">Googleでログイン→仮コックピット表示。ここでは計測・DB書き込みはまだ行いません。</div>
        </div>
        <div>
          <button id="signinBtn">Googleでログイン</button>
          <button id="signoutBtn" class="ghost hidden">ログアウト</button>
        </div>
      </div>

      <div id="authed" class="hidden">
        <div class="row" style="margin-top:14px">
          <img id="avatar" src="" alt="" style="width:40px;height:40px;border-radius:50%;border:1px solid rgba(52,58,64,.25)">
          <div class="grow">
            <div id="username" style="font-weight:800"></div>
            <div class="muted" id="email"></div>
          </div>
          <span class="tag">v0 スモーク</span>
        </div>

        <div class="grid">
          <div class="stat"><div class="label">現在の時給（仮）</div><div class="val" id="wage">¥0</div></div>
          <div class="stat"><div class="label">今日の件数（仮）</div><div class="val" id="orders">0</div></div>
          <div class="stat"><div class="label">稼働時間（仮）</div><div class="val" id="time">0:00</div></div>
        </div>

        <div class="rowbtn">
          <button id="startBtn">開始</button>
          <button id="pauseBtn" class="ghost">一時停止</button>
          <button id="stopBtn" class="ghost">終了</button>
        </div>

        <div class="map">（ここにGoogleマップを統合予定／現在はダミー表示）</div>
      </div>

      <div id="unauthed" style="margin-top:18px" class="muted">
        ログインすると、ここにコックピットが表示されます。
      </div>

      <div class="footer">© Jikyuu Hacker</div>
    </div>

    <!-- Firebase (Modules via CDN) -->
    <script type="module">
      // ★ ここは「あなたの既存の値」をそのまま残してください（置き換えない）
      const firebaseConfig = {
        apiKey: "（あなたの値）",
        authDomain: "（あなたの値）",
        projectId: "（あなたの値）",
        appId: "（あなたの値）",
        storageBucket: "（あなたの値）",
        messagingSenderId: "（あなたの値）"
      };

      /* v11.0.1 で import を統一 */
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
      import {
        getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged
      } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      auth.languageCode = "ja";
      const provider = new GoogleAuthProvider();

      const $ = (id)=>document.getElementById(id);
      const show = (el)=>el.classList.remove("hidden");
      const hide = (el)=>el.classList.add("hidden");

      $("signinBtn").addEventListener("click", async ()=>{
        try{ await signInWithPopup(auth, provider); }
        catch(e){ alert("ログインに失敗しました: " + e.message); }
      });
      $("signoutBtn").addEventListener("click", async ()=>{ await signOut(auth); });

      // 仮ボタン：まだDBは使わないので数字だけ動かす
      let seconds = 0, orders = 0, earned = 0, timerId = null;
      $("startBtn").addEventListener("click", ()=>{
        if(timerId) return;
        timerId = setInterval(()=>{
          seconds += 5; earned += 10; // 5秒ごとに¥10加算（デモ）
          $("time").textContent = `${Math.floor(seconds/60)}:${String(seconds%60).padStart(2,"0")}`;
          $("wage").textContent = `¥${(seconds? Math.round((earned/(seconds/3600))) : 0).toLocaleString()}`;
        }, 5000);
      });
      $("pauseBtn").addEventListener("click", ()=>{ if(timerId){ clearInterval(timerId); timerId=null; }});
      $("stopBtn").addEventListener("click", ()=>{
        seconds=0; orders=0; earned=0;
        ["time","wage","orders"].forEach(id=>$(id).textContent = id==="time" ? "0:00" : "0");
        if(timerId){ clearInterval(timerId); timerId=null; }
      });

      onAuthStateChanged(auth, (user)=>{
        if(user){
          $("username").textContent = user.displayName || "配達員さん";
          $("email").textContent = user.email || "";
          $("avatar").src = user.photoURL || "";
          show($("authed")); show($("signoutBtn")); hide($("signinBtn")); hide($("unauthed"));
        }else{
          hide($("authed")); hide($("signoutBtn")); show($("signinBtn")); show($("unauthed"));
        }
      });
    </script>
  </body>
</html>
